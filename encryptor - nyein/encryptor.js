// put keys in backtick (``) to avoid errors caused by spaces or tabs
const publicKeyArmored = `-----BEGIN PGP PUBLIC KEY BLOCK-----

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
kwyvF99DoFEd
=9Kst
-----END PGP PUBLIC KEY BLOCK-----`;

async function foo(msg) {
    const {data: encrypted} = await openpgp.encrypt({
        message: openpgp.message.fromText(`${msg}`),                 // input as Message object
        publicKeys: (await openpgp.key.readArmored(publicKeyArmored)).keys // for encryption
    });
    // console.log(encrypted); // '-----BEGIN PGP MESSAGE ... END PGP MESSAGE-----'
    app.encrypted_message = encrypted;
    copyToClipboard(encrypted);
}

// https://stackoverflow.com/questions/33855641/copy-output-of-a-javascript-variable-to-the-clipboard
function copyToClipboard(text) {
    var dummy = document.createElement("textarea");
    // to avoid breaking orgain page when copying more words
    // cant copy when adding below this code
    // dummy.style.display = 'none'
    document.body.appendChild(dummy);
    //Be careful if you use texarea. setAttribute('value', value), which works with "input" does not work with "textarea". â€“ Eduard
    dummy.value = text;
    dummy.select();
    document.execCommand("copy");
    document.body.removeChild(dummy);
}

var app = new Vue({
    el: '#app',
    data: {
        message: '',
        encrypted_message: ''
    },
    computed: {},
    methods: {
        encryptThis: function () {
            foo(this.message);
        }
    }
});
